openapi: 3.0.1
info:
  title: FA server API
  description: 'FA server API'
  version: 1.0.0
servers:
  - url: '{URL}'

paths:
  /api/authorize:
    post:
      summary: Authorize using email password
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthorizeRequest'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthorizeResponse'
      security:
        - PublicAuth: [ ]
      operationId: authorize
      tags: [ auth ]

  /api/oauth-authorization-links:
    get:
      summary: Authorization oauth links
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthorizationLinksResponse'
      security:
        - PublicAuth: [ ]
      operationId: authorizationLinks
      tags: [ auth ]

  /api/authorize-oauth:
    post:
      summary: Authorize via oauth
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/AuthorizeOauthRequest'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthorizeResponse'
      security:
        - PublicAuth: [ ]
      operationId: authorizeOauth
      tags: [ auth ]

  /api/registration/start:
    post:
      summary: Start registration with email password
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RegistrationRequest'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/RegistrationResponse'
      security:
        - PublicAuth: [ ]
      operationId: startRegistration
      tags: [ registration ]

  /api/register/confirm:
    post:
      summary: Confirm registration with email password
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SubmitRegistrationRequest'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthorizeResponse'
      security:
        - PublicAuth: [ ]
      operationId: confirmRegistration
      tags: [ registration ]

  /api/user:
    put:
      summary: Update user information
      requestBody:
        description: Updated user data
        required: true
        content:
          application/json:
            schema:
              $ref: "#/components/schemas/UserUpdateRequest"
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: updateUser
      tags: [ user ]
    delete:
      summary: Delete user
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: deleteUser
      tags: [ user ]

  /api/user/change-email:
    post:
      summary: Change email
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangeEmailRequest'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ChangeEmailResponse'
      security:
        - TokenAuth: [ ]
      operationId: changeEmail
      tags: [ user ]

  /api/user/change-email-confirmation:
    post:
      summary: Confirm change email
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ChangeEmailConfirmationRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - PublicAuth: [ ]
      operationId: confirmChangeEmail
      tags: [ user ]

  /api/user/check-email-uniqueness/{email}:
    get:
      summary: Check email uniqueness
      parameters:
        - in: path
          name: email
          schema:
            type: string
          required: true
          description: Return true if such e-mail already exists
      responses:
        200:
          description: Success
          content:
            'application/json':
              schema:
                type: boolean
      security:
        - PublicAuth: [ ]
      operationId: existsByEmail
      tags: [ user ]

  /api/user/check-username-uniqueness/{username}:
    get:
      summary: Check email uniqueness
      parameters:
        - in: path
          name: username
          schema:
            type: string
          required: true
          description: Return true if such username already exists
      responses:
        200:
          description: Success
          content:
            'application/json':
              schema:
                type: boolean
      security:
        - PublicAuth: [ ]
      operationId: existsByUsername
      tags: [ user ]

  /api/user/request-password-reset:
    post:
      summary: Request password reset
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/RequestPasswordResetRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - PublicAuth: [ ]
      operationId: requestPasswordReset
      tags: [ user ]

  /api/user/reset-password:
    post:
      summary: Reset password with reset id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordResetRequest'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/AuthorizeResponse'
      security:
        - PublicAuth: [ ]
      operationId: resetPassword
      tags: [ user ]

  /api/user/change-password:
    post:
      summary: Change password
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PasswordChangeRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: changePassword
      tags: [ user ]

  /api/user/set-password:
    post:
      summary: Set password
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/SetPasswordRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: setPassword
      tags: [ user ]

  /api/user/get-me:
    get:
      summary: Get user information
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetMeResponse'
      security:
        - TokenAuth: [ ]
      operationId: getMe
      tags: [ user ]

  /api/user/get-user-info/{id}:
    parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        required: true
    get:
      summary: Get other user information
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfo'
      security:
        - PublicAuth: [ ]
      operationId: getUserInfo
      tags: [ user ]


  /api/user/get-user-info-by-user-name/{username}:
    parameters:
      - in: path
        name: username
        schema:
          type: string
        required: true
    get:
      summary: Get other user information by username
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/UserInfo'
      security:
        - PublicAuth: [ ]
      operationId: getUserInfoByUsername
      tags: [ user ]

  /api/publication:
    post:
      summary: Create publication
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CreatePublicationResponse'
      security:
        - TokenAuth: [ ]
      operationId: createPublication
      tags: [ publication ]

  /api/user/publications:
    get:
      summary: Get user publications
      parameters:
        - in: query
          name: status
          schema:
            $ref: '#/components/schemas/PublicationStatus'
          required: true
          description: Status of publication
        - in: query
          name: page
          schema:
            type: integer
          required: true
          description: Page number
        - in: query
          name: pageSize
          schema:
            type: integer
          required: true
          description: Page size
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicationsResponse'
      security:
        - TokenAuth: [ ]
      operationId: getMyPublications
      tags: [ publication ]

  /api/user-publications/{username}:
    get:
      summary: Get user publications by username
      parameters:
        - in: path
          name: username
          schema:
            type: string
          required: true
          description: Username
        - in: query
          name: status
          schema:
            $ref: '#/components/schemas/PublicationStatus'
          required: true
          description: Status of publication
        - in: query
          name: page
          schema:
            type: integer
          required: true
          description: Page number
        - in: query
          name: pageSize
          schema:
            type: integer
          required: true
          description: Page size
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicationsResponse'
      security:
        - PublicAuth: [ ]
      operationId: getUserPublications
      tags: [ publication ]

  /api/publications:
    get:
      summary: Get all publications
      parameters:
        - in: query
          name: page
          schema:
            type: integer
          required: true
          description: Page number
        - in: query
          name: pageSize
          schema:
            type: integer
          required: true
          description: Page size
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicationsResponse'
      security:
        - PublicAuth: [ ]
      operationId: getAllPublications
      tags: [ publication ]

  /api/publications/featured:
    get:
      summary: Get all featured publications
      parameters:
        - in: query
          name: page
          schema:
            type: integer
          required: true
          description: Page number
        - in: query
          name: pageSize
          schema:
            type: integer
          required: true
          description: Page size
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicationsResponse'
      security:
        - PublicAuth: [ ]
      operationId: getAllFeaturedPublications
      tags: [ publication ]

  /api/publication/{id}:
    get:
      summary: Get publication
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/Publication'
      security:
        - PublicAuth: [ ]
      operationId: getPublication
      tags: [ publication ]
    delete:
      summary: Delete draft publication
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: delete
      tags: [ publication ]
    patch:
      summary: Edit publication
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/PublicationEditRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: editPublication
      tags: [ publication ]

  /api/publication/downloaders/{id}:
    get:
      summary: Get publication
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
        - in: query
          name: page
          schema:
            type: integer
          required: true
          description: Page number
        - in: query
          name: pageSize
          schema:
            type: integer
          required: true
          description: Page size
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/GetDownloadersResponse'
      security:
        - PublicAuth: [ ]
      operationId: getPublicationDownloaders
      tags: [ publication ]

  /api/publication/search:
    get:
      summary: Search publications
      parameters:
        - in: query
          name: text
          schema:
            type: string
          required: true
          description: Entry
        - in: query
          name: limit
          schema:
            type: integer
            maximum: 100
        - in: query
          name: pageNum
          schema:
            type: integer
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/SearchPublicationsResponse'
      security:
        - PublicAuth: [ ]
      operationId: searchPublications
      tags: [ publication ]

  /api/publication/{id}/submit:
    put:
      summary: Submit publication
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
        - in: query
          name: accessType
          schema:
            $ref: '#/components/schemas/AccessType'
          required: true
          description: Access level for publication
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: submitPublication
      tags: [ publication ]

  /api/publication/{id}/request-download:
    put:
      summary: Request publication archive download
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: requestDownload
      tags: [ publication ]

  /api/publication/{id}/view/increment:
    post:
      summary: Update publication view count
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
      responses:
        200:
          description: Success
      security:
        - PublicAuth: [ ]
      operationId: incrementPublicationViewCount
      tags: [ publication ]

  /api/publication/{id}/download-link:
    get:
      summary: Get publication content download link
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DownloadLinkResponse'
      security:
        - TokenAuth: [ ]
      operationId: getDownloadLink
      tags: [ publication ]

  /api/publication/files/download:
    get:
      parameters:
        - name: downloadToken
          in: query
          required: true
          schema:
            type: string
            maxLength: 2048
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                type: string
                format: binary
        '404':
          description: File not found
        '500':
          description: Server error
      security:
        - PublicAuth: [ ]
      operationId: downloadPublicationFiles
      tags: [ publication ]

  /api/publication/{id}/files/sample/download:
    parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        required: true
    get:
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                type: string
                format: binary
        '404':
          description: File not found
        '500':
          description: Server error
      security:
        - PublicAuth: [ ]
      operationId: downloadPublicationSampleFiles
      tags: [ publication ]

  /api/files/check-duplicates/{publicationId}:
    post:
      summary: Check file duplicates
      parameters:
        - in: path
          name: publicationId
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckFileDuplicatesRequest'
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckFileDuplicatesResponse'
      security:
        - TokenAuth: [ ]
      operationId: checkFileDuplicates
      tags: [ file ]

  /api/files/upload:
    post:
      summary: Upload file
      parameters:
        - in: query
          name: publicationId
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
        - in: query
          name: fullPath
          schema:
            type: string
          required: true
          description: Full file path
        - in: query
          name: isDir
          schema:
            type: boolean
          required: true
          description: Is this file or directory
        - in: query
          name: type
          schema:
            $ref: '#/components/schemas/UploadType'
          required: true
          description: In case of file duplication replace or rename
        - in: query
          name: contentLength
          schema:
            type: integer
            format: int64
          required: false
      requestBody:
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
        required: false
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicationFile'
      security:
        - TokenAuth: [ ]
      operationId: uploadFile
      tags: [ file ]

  /api/files/download/{file_id}:
    get:
      summary: Download a file
      description: Retrieves a file for download based on the provided file ID.
      parameters:
        - name: file_id
          in: path
          description: ID of the file to download
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                type: string
                format: binary
        '404':
          description: File not found
        '500':
          description: Server error
      security:
        - PublicAuth: [ ]
      operationId: downloadPublicationFile
      tags: [ file ]

  /api/files/token/{file_id}:
    get:
      summary: Get token to retrieve download link
      parameters:
        - name: file_id
          in: path
          description: ID of the file to download
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DownloadTokenResponse'
        '404':
          description: File not found
        '500':
          description: Server error
      security:
        - TokenAuth: [ ]
      operationId: getTokenToRetrieveDownloadLink
      tags: [ file ]

  /api/files/download-link:
    get:
      summary: Get download link for publication file
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DownloadLinkRequest'
      responses:
        200:
          description: Success
          content:
            text/plain:
              schema:
                type: string
      security:
        - PublicToken: [ ]
      operationId: getDownloadLinkForPublicationFile
      tags: [ file ]

  /api/author/{searchText}:
    get:
      summary: Get users by search text
      parameters:
        - in: path
          name: searchText
          schema:
            type: string
          required: true
          description: Search text for users
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/UserInfo'
      security:
        - TokenAuth: [ ]
      operationId: getAuthors
      tags: [ author ]

  /api/author/top:
    get:
      summary: Get top authors
      parameters:
        - in: query
          name: page
          schema:
            type: integer
          required: true
          description: Page number
        - in: query
          name: pageSize
          schema:
            type: integer
          required: true
          description: Page size
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/TopAuthorsResponse'
      security:
        - PublicAuth: [ ]
      operationId: getTopAuthors
      tags: [ author ]


  /api/files:
    parameters:
      - in: query
        name: publicationId
        schema:
          type: string
          format: uuid
        required: true
        description: Publication id
    get:
      summary: Get files by publication id
      parameters:
        - in: query
          name: dirPath
          schema:
            type: string
          required: true
          description: Directory path
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PublicationFile'
      security:
        - PublicAuth: [ ]
      operationId: getPublicationFiles
      tags: [ file ]
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateFolderRequest'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicationFile'
      security:
        - TokenAuth: [ ]
      operationId: createFolder
      tags: [ file ]

  /api/files/{id}:
    parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        required: true
        description: Id of file or directory
    put:
      summary: Patch file
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EditFileRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: editFile
      tags: [ file ]

  /api/files/deleteByIds:
    delete:
      summary: Delete file by id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteByIdsRequest'
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: deleteFiles
      tags: [ file ]

  /api/files/move/{id}:
    post:
      summary: Move file by id
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Id of file or directory
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MoveFileRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: moveFile
      tags: [ file ]

  /api/sample-files:
    parameters:
      - in: query
        name: publicationId
        schema:
          type: string
          format: uuid
        required: true
        description: Publication id
    get:
      summary: Get sample files by publication id
      parameters:
        - in: query
          name: dirPath
          schema:
            type: string
          required: true
          description: Directory path
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                type: array
                items:
                  $ref: '#/components/schemas/PublicationFile'
      security:
        - PublicAuth: [ ]
      operationId: getPublicationSampleFiles
      tags: [ sampleFile ]
    post:
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CreateFolderRequest'
        required: true
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicationFile'
      security:
        - TokenAuth: [ ]
      operationId: createFolderForSampleFile
      tags: [ sampleFile ]


  /api/sample-files/check-duplicates/{publicationId}:
    post:
      summary: Check file duplicates
      parameters:
        - in: path
          name: publicationId
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CheckFileDuplicatesRequest'
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/CheckFileDuplicatesResponse'
      security:
        - TokenAuth: [ ]
      operationId: checkSampleFileDuplicates
      tags: [ sampleFile ]

  /api/sample-files/upload:
    post:
      summary: Upload sample file
      parameters:
        - in: query
          name: publicationId
          schema:
            type: string
            format: uuid
          required: true
          description: Publication id
        - in: query
          name: fullPath
          schema:
            type: string
          required: true
          description: Full file path
        - in: query
          name: isDir
          schema:
            type: boolean
          required: true
          description: Is this file or directory
        - in: query
          name: type
          schema:
            $ref: '#/components/schemas/UploadType'
          required: true
          description: In case of file duplication replace or rename
        - in: query
          name: contentLength
          schema:
            type: integer
            format: int64
          required: false
      requestBody:
        content:
          application/octet-stream:
            schema:
              type: string
              format: binary
        required: false
      responses:
        200:
          description: Success
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/PublicationFile'
      security:
        - TokenAuth: [ ]
      operationId: uploadSampleFile
      tags: [ sampleFile ]

  /api/sample-files/download/{file_id}:
    get:
      summary: Download a sample file
      description: Retrieves a sample file for download based on the provided file ID.
      parameters:
        - name: file_id
          in: path
          description: ID of the sample file to download
          required: true
          schema:
            type: string
            format: uuid
      responses:
        '200':
          description: OK
          content:
            '*/*':
              schema:
                type: string
                format: binary
        '404':
          description: File not found
        '500':
          description: Server error
      security:
        - PublicAuth: [ ]
      operationId: downloadPublicationSampleFile
      tags: [ sampleFile ]

  /api/sample-files/{id}:
    parameters:
      - in: path
        name: id
        schema:
          type: string
          format: uuid
        required: true
        description: Id of sample file or directory
    put:
      summary: Patch file
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/EditFileRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: editSampleFile
      tags: [ sampleFile ]

  /api/sample-files/deleteByIds:
    delete:
      summary: Delete sample file by id
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/DeleteByIdsRequest'
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: deleteSampleFiles
      tags: [ sampleFile ]

  /api/sample-files/move/{id}:
    post:
      summary: Move sample file by id
      parameters:
        - in: path
          name: id
          schema:
            type: string
            format: uuid
          required: true
          description: Id of sample file or directory
      requestBody:
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/MoveFileRequest'
        required: true
      responses:
        200:
          description: Success
      security:
        - TokenAuth: [ ]
      operationId: moveSampleFile
      tags: [ sampleFile ]

components:
  schemas:
    PublicationFile:
      type: object
      properties:
        id:
          type: string
          format: uuid
        publicationId:
          type: string
          format: uuid
        fullPath:
          type: string
        description:
          type: string
        dirPath:
          type: string
        isDir:
          type: boolean
        hash:
          type: string
        size:
          type: integer
          format: int64
        creationTime:
          type: string
          format: date-time

    CheckFileDuplicatesRequest:
      type: object
      properties:
        fullPathList:
          type: array
          items:
            type: string
      required:
        - fullPathList

    CheckFileDuplicatesResponse:
      type: object
      additionalProperties:
        type: boolean

    EditFileRequest:
      type: object
      properties:
        name:
          type: string
        description:
          type: string
          maxLength: 4096
      required:
        - name

    DeleteByIdsRequest:
      type: object
      properties:
        ids:
          type: array
          items:
            type: string
            format: uuid
      required:
        - ids

    MoveFileRequest:
      type: object
      properties:
        newDirPath:
          type: string
          minLength: 0
      required:
        - newDirPath

    CreateFolderRequest:
      type: object
      properties:
        dirPath:
          type: string
        name:
          type: string
        description:
          type: string
      required:
        - dirPath
        - name

    SubmitRegistrationRequest:
      type: object
      properties:
        registrationToken:
          type: string
          format: uuid
        code:
          type: string
      required:
        - registrationToken
        - code

    RegistrationRequest:
      type: object
      properties:
        email:
          type: string
        firstName:
          type: string
        lastName:
          type: string
        password:
          type: string
          minLength: 8
      required:
        - email
        - password

    RegistrationResponse:
      type: object
      properties:
        registrationToken:
          type: string
          format: uuid
      required:
        - registrationToken

    PasswordChangeRequest:
      type: object
      properties:
        newPassword:
          type: string
          minLength: 8
        previousPassword:
          type: string
          minLength: 8
      required:
        - newPassword
        - previousPassword

    SetPasswordRequest:
      type: object
      properties:
        newPassword:
          type: string
          minLength: 8
      required:
        - newPassword

    PasswordResetRequest:
      type: object
      properties:
        password:
          type: string
          minLength: 8
        passwordResetRequestId:
          type: string
          format: uuid
      required:
        - password
        - code

    RequestPasswordResetRequest:
      type: object
      properties:
        email:
          type: string
      required:
        - email

    SendPasswordResetLinkRequest:
      type: object
      properties:
        email:
          type: string
      required:
        - email

    AuthorizeRequest:
      type: object
      properties:
        email:
          type: string
        password:
          type: string
          minLength: 8
      required:
        - email
        - password

    AuthorizeOauthRequest:
      type: object
      properties:
        code:
          type: string
          maxLength: 2048
        type:
          $ref: '#/components/schemas/OauthType'
      required:
        - code
        - type

    AuthorizeResponse:
      type: object
      properties:
        token:
          type: string

    AuthorizationLinksResponse:
      type: object
      properties:
        google:
          type: string
          maxLength: 2048
        facebook:
          type: string
          maxLength: 2048
        linkedin:
          type: string
          maxLength: 2048
        orcid:
          type: string
          maxLength: 2048

    ChangeEmailRequest:
      type: object
      properties:
        email:
          type: string
      required:
        - email

    ChangeEmailResponse:
      type: object
      properties:
        confirmationToken:
          type: string
          format: uuid
      required:
        - confirmationToken

    ChangeEmailConfirmationRequest:
      type: object
      properties:
        confirmationToken:
          type: string
          format: uuid
        code:
          type: string
      required:
        - confirmationToken
        - code

    CreatePublicationResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        status:
          $ref: '#/components/schemas/PublicationStatus'
        contentStatus:
          $ref: '#/components/schemas/PublicationContentStatus'
        creationTime:
          type: string
          format: date-time
        publicationTime:
          type: string
          format: date-time
      required:
        - id
        - status
        - creationTime

    GetMeResponse:
      type: object
      properties:
        id:
          type: string
          format: uuid
        firstName:
          type: string
        middleName:
          type: string
        lastName:
          type: string
        username:
          type: string
        email:
          type: string
        canSetPassword:
          type: boolean
        canChangePassword:
          type: boolean
        selfInfo:
          type: string
        profileImage:
          type: string
          format: byte
        signedVia:
          type: array
          items:
            $ref: '#/components/schemas/OauthType'
      required:
        - id
        - firstName
        - lastName
        - username
        - email
        - canSetPassword
        - canChangePassword
        - selfInfo

    UserInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
        firstName:
          type: string
        middleName:
          type: string
        lastName:
          type: string
        email:
          type: string
        username:
          type: string
        selfInfo:
          type: string
        profileImage:
          type: string
          format: byte
      required:
        - id
        - firstName
        - lastName
        - email
        - username
        - selfInfo

    UploadType:
      type: string
      enum:
        - REPLACE
        - RENAME

    OauthType:
      type: string
      enum:
        - GOOGLE
        - FACEBOOK
        - LINKEDIN
        - ORCID

    PublicationStatus:
      type: string
      enum:
        - PENDING
        - READY_FOR_PUBLICATION
        - PUBLISHED

    PublicationContentStatus:
      type: string
      enum:
        - PENDING
        - INSTANT
        - ENCRYPTED
        - ARCHIVE
        - ABSENT

    AccessType:
      type: string
      enum:
        - CLOSED
        - OPEN
        - ON_REQUEST
        - MONETIZE_OR_CO_AUTHORSHIP

    LicenseType:
      type: string
      enum:
        - ATTRIBUTION_NO_DERIVATIVES
        - ATTRIBUTION_NO_DERIVATIVES_NON_COMMERCIAL
        - DUMMY

    UserUpdateRequest:
      type: object
      properties:
        firstName:
          type: string
        middleName:
          type: string
        lastName:
          type: string
        username:
          type: string
        selfInfo:
          type: string
          maxLength: 4096
        profileImage:
          type: string
          format: byte
          maxLength: 2097152
        deleteProfileImage:
          type: boolean
      required:
        - firstName
        - lastName
        - username

    PublicationEditRequest:
      type: object
      properties:
        confirmedAuthors:
          $ref: '#/components/schemas/ConfirmedAuthors'
        unconfirmedAuthors:
          $ref: '#/components/schemas/UnconfirmedAuthors'
        title:
          $ref: '#/components/schemas/PublicationStringValue'
        researchAreas:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        description:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        grantOrganizations:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        primaryArticles:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        relatedArticles:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        tags:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        objectOfStudyTitle:
          $ref: '#/components/schemas/PublicationStringValue'
        objectOfStudyDescription:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        software:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        methodTitle:
          $ref: '#/components/schemas/PublicationStringValue'
        methodDescription:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        predictedGoals:
          $ref: '#/components/schemas/PublicationStringArrayValue'
        negativeData:
          $ref: '#/components/schemas/PublicationStringValue'
        isNegative:
          type: boolean
        licenseType:
          $ref: '#/components/schemas/PublicationLicenseTypeValue'

    PublicationStringValue:
      type: object
      properties:
        edited:
          type: boolean
        value:
          type: string
          maxLength: 32768

    PublicationLicenseTypeValue:
      type: object
      properties:
        edited:
          type: boolean
        value:
          $ref: '#/components/schemas/LicenseType'

    PublicationStringArrayValue:
      type: object
      properties:
        edited:
          type: boolean
        values:
          type: array
          items:
            $ref: '#/components/schemas/Paragraph'

    Paragraph:
      type: object
      properties:
        text:
          type: string
          maxLength: 32768
      required:
        - text

    ConfirmedAuthors:
      type: object
      properties:
        edited:
          type: boolean
        values:
          type: array
          items:
            $ref: '#/components/schemas/ConfirmedAuthorBasicInfo'

    ConfirmedAuthor:
      type: object
      properties:
        id:
          type: string
          format: uuid
        user:
          $ref: '#/components/schemas/UserInfo'
        shortBio:
          type: string
      required:
        - user

    ConfirmedAuthorBasicInfo:
      type: object
      properties:
        id:
          type: string
          format: uuid
        userId:
          type: string
          format: uuid
        shortBio:
          type: string
      required:
        - userId

    UnconfirmedAuthors:
      type: object
      properties:
        edited:
          type: boolean
        values:
          type: array
          items:
            $ref: '#/components/schemas/UnconfirmedAuthor'

    UnconfirmedAuthor:
      type: object
      properties:
        id:
          type: string
          format: uuid
        email:
          type: string
        firstName:
          type: string
        middleName:
          type: string
        lastName:
          type: string
        shortBio:
          type: string
      required:
        - email
        - firstName
        - lastName

    Downloader:
      type: object
      properties:
        id:
          type: string
          format: uuid
      required:
        - email
        - firstName
        - lastName

    SearchPublicationsResponse:
      type: object
      properties:
        items:
          type: array
          items:
            $ref: "#/components/schemas/Publication"
        pageNum:
          type: integer
        isLast:
          type: boolean
      required:
        - pageNum
        - isLast

    Publication:
      type: object
      properties:
        id:
          type: string
          format: uuid
        creator:
          $ref: '#/components/schemas/UserInfo'
        status:
          $ref: '#/components/schemas/PublicationStatus'
        accessType:
          $ref: '#/components/schemas/AccessType'
        licenseType:
          $ref: '#/components/schemas/LicenseType'
        contentStatus:
          $ref: '#/components/schemas/PublicationContentStatus'
        creationTime:
          type: string
          format: date-time
        editingTime:
          type: string
          format: date-time
        publicationTime:
          type: string
          format: date-time
        title:
          type: string
          maxLength: 32768
        description:
          $ref: '#/components/schemas/StringArray'
        researchAreas:
          $ref: '#/components/schemas/StringArray'
        grantOrganizations:
          $ref: '#/components/schemas/StringArray'
        primaryArticles:
          $ref: '#/components/schemas/StringArray'
        relatedArticles:
          $ref: '#/components/schemas/StringArray'
        tags:
          $ref: '#/components/schemas/StringArray'
        objectOfStudyTitle:
          type: string
          maxLength: 32768
        objectOfStudyDescription:
          $ref: '#/components/schemas/StringArray'
        software:
          $ref: '#/components/schemas/StringArray'
        methodTitle:
          type: string
          maxLength: 32768
        methodDescription:
          $ref: '#/components/schemas/StringArray'
        predictedGoals:
          $ref: '#/components/schemas/StringArray'
        confirmedAuthors:
          type: array
          items:
            $ref: '#/components/schemas/ConfirmedAuthor'
        unconfirmedAuthors:
          type: array
          items:
            $ref: '#/components/schemas/UnconfirmedAuthor'
        negativeData:
          type: string
          maxLength: 32768
        isNegative:
          type: boolean
        viewsCount:
          type: integer
          format: int64
        downloadsCount:
          type: integer
          format: int64
        total:
          type: number
          format: integer
        archiveSize:
          type: integer
          format: int64
        sampleArchiveSize:
          type: integer
          format: int64
      required:
        - id
        - status
        - creator
        - isNegative
        - creationTime
        - editingTime
        - total

    PublicationsResponse:
      type: object
      properties:
        isLastPage:
          type: boolean
        publications:
          type: array
          items:
            $ref: '#/components/schemas/Publication'
      required:
        - isLastPage

    TopAuthorsResponse:
      type: object
      properties:
        isLastPage:
          type: boolean
        authors:
          type: array
          items:
            $ref: '#/components/schemas/UserInfo'

    GetDownloadersResponse:
      type: object
      properties:
        isLastPage:
          type: boolean
        downloaders:
          type: array
          items:
            $ref: '#/components/schemas/UserInfo'
      required:
        - downloaders
        - isLastPage

    StringArray:
      type: array
      items:
        $ref: '#/components/schemas/Paragraph'

    DownloadTokenResponse:
      type: object
      properties:
        token:
          type: string
      required:
        - token

    DownloadLinkRequest:
      type: object
      properties:
        token:
          type: string
          maxLength: 2048

    DownloadLinkResponse:
      type: object
      properties:
        link:
          type: string
        passcode:
          type: string
      required:
        - link
        - passcode

  securitySchemes:
    PublicAuth:
      description: Public access
      type: http
      scheme: mutual

    TokenAuth:
      description: Access with auth JWT token
      type: http
      scheme: bearer
